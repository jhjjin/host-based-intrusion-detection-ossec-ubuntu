# OSSEC HIDS Project

Host-Based Intrusion Detection  
Suspicious Process Execution Detection

This project implements a Host-Based Intrusion Detection System (HIDS) using OSSEC on
an Ubuntu Linux virtual machine. The system monitors authentication logs and process
execution activity to detect suspicious behavior such as SSH brute-force attempts and
unknown executable execution.

This was completed as an individual project for ECE 4309.

---

## Project Overview

The goal of this project was to install, configure, and evaluate OSSEC as a host-based
intrusion detection system. The system was tested by simulating common attack scenarios
and analyzing the alerts generated by OSSEC.

The following tasks were completed:
- Installed and configured OSSEC on an Ubuntu virtual machine
- Detected suspicious SSH login attempts (brute-force simulation)
- Detected suspicious process execution using auditd and OSSEC
- Analyzed OSSEC alerts to understand HIDS behavior and rule matching

---

## What is a HIDS?

A Host-Based Intrusion Detection System (HIDS) monitors activity on a single host to
identify potential security threats.

Key characteristics:
- Monitors authentication logs, system logs, and file activity
- Detects suspicious behavior using predefined rules
- Generates alerts when abnormal activity is detected
- Lightweight and suitable for single-host monitoring

---

## System Architecture

- Ubuntu 25.04 (ARM) running in VMware Fusion on macOS
- OSSEC installed in local (standalone) mode
- Monitored log sources:
  - `/var/log/auth.log` for authentication and login events
  - Audit logs generated by `auditd` for process execution
- Alerts stored in:
  - `/var/ossec/logs/alerts/alerts.log`

---

## Installation and Verification

After installing OSSEC, the following components were verified to be running correctly:
- `ossec-monitord` (monitoring daemon)
- `ossec-logcollector` (log collection)
- `ossec-syscheckd` (file integrity monitoring)
- `ossec-analysisd` (log analysis)
- `ossec-execd` (active response handling)

---

## SSH Login Failure Detection

SSH brute-force behavior was simulated by attempting to log in with invalid usernames,
for example:
ssh wronguser@localhost

OSSEC detected repeated authentication failures and invalid user login attempts.
An example alert triggered during testing:
- Rule 5710: Attempt to login using a non-existent user

### Suspicious Process Execution Detection (auditd + OSSEC)

Suspicious process execution was simulated by running an unknown script on the system.

- `auditd` was configured to monitor process execution events  
- OSSEC analyzed audit logs and applied a custom detection rule  

**Expected alert behavior:**
- **Rule 100100**: Suspicious process execution detected (unknown executable ran)

---

## Troubleshooting and Fixes

Several issues were encountered and resolved during setup:

- Installed missing build dependencies (zlib, OpenSSL, system headers, libsystemd)
- Corrected syscheck configuration paths affected by ARM architecture differences
- Enabled and verified real-time monitoring for OSSEC and auditd
- Resolved duplicate configuration warnings during OSSEC startup

---

## Conclusion

This project successfully demonstrated the use of OSSEC as a host-based intrusion
detection system. SSH brute-force login attempts and suspicious process execution were
detected through log and audit monitoring.

Through this project, practical experience was gained in:

- HIDS installation and configuration
- Log and audit analysis
- OSSEC rule behavior and alert interpretation
- Troubleshooting Linux security tools


